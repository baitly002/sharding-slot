mode:
  type: Standalone
  repository:
    type: JDBC
dataSources:
  ds-0:
    dataSourceClassName: com.zaxxer.hikari.HikariDataSource
    type: com.zaxxer.hikari.HikariDataSource
    driverClassName: com.mysql.cj.jdbc.Driver
    jdbcUrl: jdbc:mysql://10.200.20.94:30093/demo_ds?characterEncoding=utf8&zeroDateTimeBehavior=convertToNull&useSSL=false&allowMultiQueries=true&useJDBCCompliantTimezoneShift=true&useLegacyDatetimeCode=false&serverTimezone=Asia/Shanghai&nullCatalogMeansCurrent=true&allowPublicKeyRetrieval=true
    username: root
    password: Link$2013
    maximum-pool-size: 15
    minimum-idle: 1
  ds-1:
    dataSourceClassName: com.zaxxer.hikari.HikariDataSource
    type: com.zaxxer.hikari.HikariDataSource
    driverClassName: com.mysql.cj.jdbc.Driver
    jdbcUrl: jdbc:mysql://10.200.20.94:30093/demo_ds_1?characterEncoding=utf8&zeroDateTimeBehavior=convertToNull&useSSL=false&allowMultiQueries=true&useJDBCCompliantTimezoneShift=true&useLegacyDatetimeCode=false&serverTimezone=Asia/Shanghai&nullCatalogMeansCurrent=true&allowPublicKeyRetrieval=true
    username: root
    password: Link$2013
    maximum-pool-size: 15
    minimum-idle: 1
  ds-2:
    dataSourceClassName: com.zaxxer.hikari.HikariDataSource
    type: com.zaxxer.hikari.HikariDataSource
    driverClassName: com.mysql.cj.jdbc.Driver
    jdbcUrl: jdbc:mysql://10.200.20.94:30093/demo_ds_2?characterEncoding=utf8&zeroDateTimeBehavior=convertToNull&useSSL=false&allowMultiQueries=true&useJDBCCompliantTimezoneShift=true&useLegacyDatetimeCode=false&serverTimezone=Asia/Shanghai&nullCatalogMeansCurrent=true&allowPublicKeyRetrieval=true
    username: root
    password: Link$2013
    maximum-pool-size: 15
    minimum-idle: 1


rules:
- !SHARDING
  shardingAlgorithms:
    slotAlgorithm:
      type: HASH_SLOT
#       props:
#         strategy: standard
#         algorithmClassName: com.rlynic.sharding.slot.database.strategy.HashSlotShardingAlgorithm
#       type: CLASS_BASED
    hash_mod:
      type: HASH_MOD
      props:
        sharding-count: 3
  tables:
    t_order:
      actualDataNodes: ds-$->{0..2}.t_order
      databaseStrategy:
        standard:
          shardingAlgorithmName: slotAlgorithm
          shardingColumn: order_id
      keyGenerateStrategy:
        column: order_id
        keyGeneratorName: snowflake
    t_order_item:
      actualDataNodes: ds-$->{0..2}.t_order_item
      databaseStrategy:
        standard:
          shardingAlgorithmName: slotAlgorithm
          shardingColumn: order_id
      keyGenerateStrategy:
        column: order_item_id
        keyGeneratorName: snowflake
    undo_log:
      actualDataNodes: ds-$->{0..2}.undo_log
      databaseStrategy:
        standard:
          shardingAlgorithmName: hash_mod
          shardingColumn: branch_id
  keyGenerators:
    snowflake:
      type: SNOWFLAKE
# - !TRANSACTION
#   defaultType: BASE
#   providerType: Seata
props:
  sql-show: true